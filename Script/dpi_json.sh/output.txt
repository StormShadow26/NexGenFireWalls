aspire@aspire-Aspire-A715-71G:~/Desktop/Final_scripts/dpi_json.sh$ sudo ./script.sh wlp2s0 3
                                                                                
// Flow 1
     1	{
     2	  "src_ip": "2402:3a80:1085:9745:ccb2:9613:5c0f:4d18",
     3	  "dest_ip": "64:ff9b::365c:f7ce",
     4	  "src_port": 57770,
     5	  "dst_port": 443,
     6	  "ip": 6,
     7	  "proto": "TCP",
     8	  "ndpi": {
     9	    "flow_risk": {
    10	      "46": {
    11	        "risk": "Unidirectional Traffic",
    12	        "severity": "Low",
    13	        "risk_score": {
    14	          "total": 500,
    15	          "client": 430,
    16	          "server": 70
    17	        }
    18	      }
    19	    },
    20	    "confidence": {
    21	      "6": "DPI"
    22	    },
    23	    "proto": "TLS",
    24	    "proto_id": "91",
    25	    "proto_by_ip": "Unknown",
    26	    "proto_by_ip_id": 0,
    27	    "encrypted": 1,
    28	    "breed": "Safe",
    29	    "category_id": 5,
    30	    "category": "Web"
    31	  },
    32	  "detection_completed": 0,
    33	  "check_extra_packets": 0,
    34	  "flow_id": 2,
    35	  "first_seen": 1762643895.678,
    36	  "last_seen": 1762643895.681,
    37	  "duration": 0.003,
    38	  "vlan_id": 0,
    39	  "bidirectional": 0,
    40	  "xfer": {
    41	    "data_ratio": 1.000,
    42	    "data_ratio_str": "Upload",
    43	    "src2dst_packets": 2,
    44	    "src2dst_bytes": 750,
    45	    "src2dst_goodput_bytes": 578,
    46	    "dst2src_packets": 0,
    47	    "dst2src_bytes": 0,
    48	    "dst2src_goodput_bytes": 0
    49	  },
    50	  "iat": {
    51	    "flow_min": 2,
    52	    "flow_avg": 2.0,
    53	    "flow_max": 2,
    54	    "flow_stddev": 0.0,
    55	    "c_to_s_min": 2,
    56	    "c_to_s_avg": 2.0,
    57	    "c_to_s_max": 2,
    58	    "c_to_s_stddev": 0.0,
    59	    "s_to_c_min": 0,
    60	    "s_to_c_avg": 0.0,
    61	    "s_to_c_max": 0,
    62	    "s_to_c_stddev": 0.0
    63	  },
    64	  "pktlen": {
    65	    "c_to_s_min": 149,
    66	    "c_to_s_avg": 375.0,
    67	    "c_to_s_max": 601,
    68	    "c_to_s_stddev": 226.0,
    69	    "s_to_c_min": 0,
    70	    "s_to_c_avg": 0.0,
    71	    "s_to_c_max": 0,
    72	    "s_to_c_stddev": 0.0
    73	  },
    74	  "tcp_flags": {
    75	    "cwr_count": 0,
    76	    "ece_count": 0,
    77	    "urg_count": 0,
    78	    "ack_count": 2,
    79	    "psh_count": 2,
    80	    "rst_count": 0,
    81	    "syn_count": 0,
    82	    "fin_count": 0,
    83	    "src2dst_cwr_count": 0,
    84	    "src2dst_ece_count": 0,
    85	    "src2dst_urg_count": 0,
    86	    "src2dst_ack_count": 2,
    87	    "src2dst_psh_count": 2,
    88	    "src2dst_rst_count": 0,
    89	    "src2dst_syn_count": 0,
    90	    "src2dst_fin_count": 0,
    91	    "dst2src_cwr_count": 0,
    92	    "dst2src_ece_count": 0,
    93	    "dst2src_urg_count": 0,
    94	    "dst2src_ack_count": 0,
    95	    "dst2src_psh_count": 0,
    96	    "dst2src_rst_count": 0,
    97	    "dst2src_syn_count": 0,
    98	    "dst2src_fin_count": 0
    99	  },
   100	  "c_to_s_init_win": 0,
   101	  "s_to_c_init_win": 0
   102	}


// Flow 2
     1	{
     2	  "src_ip": "2620:1ec:bdf::48",
     3	  "dest_ip": "2402:3a80:1085:9745:ccb2:9613:5c0f:4d18",
     4	  "src_port": 443,
     5	  "dst_port": 56300,
     6	  "ip": 6,
     7	  "proto": "TCP",
     8	  "ndpi": {
     9	    "confidence": {
    10	      "6": "DPI"
    11	    },
    12	    "proto": "TLS",
    13	    "proto_id": "91",
    14	    "proto_by_ip": "Azure",
    15	    "proto_by_ip_id": 276,
    16	    "encrypted": 1,
    17	    "breed": "Safe",
    18	    "category_id": 5,
    19	    "category": "Web"
    20	  },
    21	  "detection_completed": 0,
    22	  "check_extra_packets": 0,
    23	  "flow_id": 1,
    24	  "first_seen": 1762643894.909,
    25	  "last_seen": 1762643895.007,
    26	  "duration": 0.098,
    27	  "vlan_id": 0,
    28	  "bidirectional": 1,
    29	  "xfer": {
    30	    "data_ratio": 0.406,
    31	    "data_ratio_str": "Upload",
    32	    "src2dst_packets": 4,
    33	    "src2dst_bytes": 407,
    34	    "src2dst_goodput_bytes": 63,
    35	    "dst2src_packets": 2,
    36	    "dst2src_bytes": 172,
    37	    "dst2src_goodput_bytes": 0
    38	  },
    39	  "iat": {
    40	    "flow_min": 98,
    41	    "flow_avg": 98.0,
    42	    "flow_max": 98,
    43	    "flow_stddev": 0.0,
    44	    "c_to_s_min": 98,
    45	    "c_to_s_avg": 32.7,
    46	    "c_to_s_max": 98,
    47	    "c_to_s_stddev": 46.2,
    48	    "s_to_c_min": 0,
    49	    "s_to_c_avg": 0.0,
    50	    "s_to_c_max": 0,
    51	    "s_to_c_stddev": 0.0
    52	  },
    53	  "pktlen": {
    54	    "c_to_s_min": 86,
    55	    "c_to_s_avg": 101.8,
    56	    "c_to_s_max": 125,
    57	    "c_to_s_stddev": 16.6,
    58	    "s_to_c_min": 86,
    59	    "s_to_c_avg": 86.0,
    60	    "s_to_c_max": 86,
    61	    "s_to_c_stddev": 0.0
    62	  },
    63	  "tcp_flags": {
    64	    "cwr_count": 0,
    65	    "ece_count": 0,
    66	    "urg_count": 0,
    67	    "ack_count": 6,
    68	    "psh_count": 2,
    69	    "rst_count": 0,
    70	    "syn_count": 0,
    71	    "fin_count": 2,
    72	    "src2dst_cwr_count": 0,
    73	    "src2dst_ece_count": 0,
    74	    "src2dst_urg_count": 0,
    75	    "src2dst_ack_count": 4,
    76	    "src2dst_psh_count": 2,
    77	    "src2dst_rst_count": 0,
    78	    "src2dst_syn_count": 0,
    79	    "src2dst_fin_count": 1,
    80	    "dst2src_cwr_count": 0,
    81	    "dst2src_ece_count": 0,
    82	    "dst2src_urg_count": 0,
    83	    "dst2src_ack_count": 2,
    84	    "dst2src_psh_count": 0,
    85	    "dst2src_rst_count": 0,
    86	    "dst2src_syn_count": 0,
    87	    "dst2src_fin_count": 1
    88	  },
    89	  "c_to_s_init_win": 0,
    90	  "s_to_c_init_win": 0
    91	}


// Flow 3
     1	{
     2	  "src_ip": "2402:3a80:1085:9745:ccb2:9613:5c0f:4d18",
     3	  "dest_ip": "2404:6800:4009:818::2004",
     4	  "src_port": 41064,
     5	  "dst_port": 443,
     6	  "ip": 6,
     7	  "proto": "TCP",
     8	  "ndpi": {
     9	    "flow_risk": {
    10	      "46": {
    11	        "risk": "Unidirectional Traffic",
    12	        "severity": "Low",
    13	        "risk_score": {
    14	          "total": 500,
    15	          "client": 430,
    16	          "server": 70
    17	        }
    18	      }
    19	    },
    20	    "confidence": {
    21	      "1": "Match by port"
    22	    },
    23	    "proto": "TLS",
    24	    "proto_id": "91",
    25	    "proto_by_ip": "Google",
    26	    "proto_by_ip_id": 126,
    27	    "encrypted": 1,
    28	    "breed": "Safe",
    29	    "category_id": 5,
    30	    "category": "Web"
    31	  },
    32	  "detection_completed": 0,
    33	  "check_extra_packets": 0,
    34	  "flow_id": 0,
    35	  "first_seen": 1762643893.808,
    36	  "last_seen": 1762643893.808,
    37	  "duration": 0.000,
    38	  "vlan_id": 0,
    39	  "bidirectional": 0,
    40	  "xfer": {
    41	    "data_ratio": 1.000,
    42	    "data_ratio_str": "Upload",
    43	    "src2dst_packets": 1,
    44	    "src2dst_bytes": 86,
    45	    "src2dst_goodput_bytes": 0,
    46	    "dst2src_packets": 0,
    47	    "dst2src_bytes": 0,
    48	    "dst2src_goodput_bytes": 0
    49	  },
    50	  "iat": {
    51	    "flow_min": 0,
    52	    "flow_avg": 0.0,
    53	    "flow_max": 0,
    54	    "flow_stddev": 0.0,
    55	    "c_to_s_min": 0,
    56	    "c_to_s_avg": 0.0,
    57	    "c_to_s_max": 0,
    58	    "c_to_s_stddev": 0.0,
    59	    "s_to_c_min": 0,
    60	    "s_to_c_avg": 0.0,
    61	    "s_to_c_max": 0,
    62	    "s_to_c_stddev": 0.0
    63	  },
    64	  "pktlen": {
    65	    "c_to_s_min": 86,
    66	    "c_to_s_avg": 86.0,
    67	    "c_to_s_max": 86,
    68	    "c_to_s_stddev": 0.0,
    69	    "s_to_c_min": 0,
    70	    "s_to_c_avg": 0.0,
    71	    "s_to_c_max": 0,
    72	    "s_to_c_stddev": 0.0
    73	  },
    74	  "tcp_flags": {
    75	    "cwr_count": 0,
    76	    "ece_count": 0,
    77	    "urg_count": 0,
    78	    "ack_count": 1,
    79	    "psh_count": 0,
    80	    "rst_count": 0,
    81	    "syn_count": 0,
    82	    "fin_count": 1,
    83	    "src2dst_cwr_count": 0,
    84	    "src2dst_ece_count": 0,
    85	    "src2dst_urg_count": 0,
    86	    "src2dst_ack_count": 1,
    87	    "src2dst_psh_count": 0,
    88	    "src2dst_rst_count": 0,
    89	    "src2dst_syn_count": 0,
    90	    "src2dst_fin_count": 1,
    91	    "dst2src_cwr_count": 0,
    92	    "dst2src_ece_count": 0,
    93	    "dst2src_urg_count": 0,
    94	    "dst2src_ack_count": 0,
    95	    "dst2src_psh_count": 0,
    96	    "dst2src_rst_count": 0,
    97	    "dst2src_syn_count": 0,
    98	    "dst2src_fin_count": 0
    99	  },
   100	  "c_to_s_init_win": 0,
   101	  "s_to_c_init_win": 0
   102	}

